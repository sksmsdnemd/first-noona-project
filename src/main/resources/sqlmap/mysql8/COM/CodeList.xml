<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="comboBoxCode"> 
    <typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap" />
   	
 	<!-- 회사아이디 -->  
	<select id="comboBoxCode.getTenantList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getTenantList */
		SELECT TENANT_ID CODE, TENANT_NAME CODE_NM
		  FROM TB_MNG_COMPANY
		 WHERE EXPIRE_DATE IS NULL
			OR IFNULL(EXPIRE_DATE, '') = ''
		 ORDER BY TENANT_NAME
	</select>	

	<!-- 그룹아이디 -->
	<select id="comboBoxCode.getGroupList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getGroupList */
		WITH RECURSIVE RE_CATE AS (
			SELECT 1 AS LEVEL
				 , ROW_NUMBER() OVER(ORDER BY GROUP_ID) AS TOP_ORDER
				 , GROUP_ID
				 , PARENT_ID
				 , GROUP_NAME
				 , GROUP_ID AS ID_PATH
			  FROM TB_MNG_GROUP
			 WHERE TENANT_ID = #findTenantId#
			<isNotEmpty property="controlAuth">
			   AND GROUP_ID IN (
				SELECT g.GROUP_ID
				  FROM TB_MNG_GROUP g
				 INNER JOIN TB_MNG_USERINFO u
					ON g.TENANT_ID = u.TENANT_ID
				   AND INSTR(CONCAT(',', CONTROL_AUTH, ','), CONCAT(',', g.GROUP_ID, ',')) > 0
				   AND u.USER_ID = #userId#
				   AND u.TENANT_ID = #findTenantId#
			   )
			 UNION ALL
			SELECT c.LEVEL + 1
				 , c.TOP_ORDER AS TOP_ORDER
				 , b.GROUP_ID
				 , b.PARENT_ID
				 , b.GROUP_NAME
				 , CONCAT(c.ID_PATH, '>', b.GROUP_ID)
			  FROM TB_MNG_GROUP b
			 INNER JOIN RE_CATE c
				ON b.TENANT_ID = #findTenantId#
			   AND c.GROUP_ID = b.PARENT_ID
			</isNotEmpty>
			<isEmpty property="controlAuth">
				<isEmpty property="grantId">
			   AND PARENT_ID = '0'
				</isEmpty>
				<isNotEmpty property="grantId">
					<isEqual property="grantId" compareValue="SuperAdmin">
			   AND PARENT_ID = '0'
					</isEqual>
					<isEqual property="grantId" compareValue="Manager">
			   AND PARENT_ID = '0'
					</isEqual>
					<isEqual property="grantId" compareValue="GroupManager">
			   AND GROUP_ID = ( SELECT GROUP_ID FROM TB_MNG_USERINFO WHERE USER_ID = #userId# AND TENANT_ID = #findTenantId# )
					</isEqual>
					<isEqual property="grantId" compareValue="Agent">
			   AND GROUP_ID = ( SELECT GROUP_ID FROM TB_MNG_USERINFO WHERE USER_ID = #userId# AND TENANT_ID = #findTenantId# )
					</isEqual>
					<isNotEqual property="grantId" compareValue="Agent">
			 UNION ALL
			SELECT c.LEVEL + 1
				 , c.TOP_ORDER AS TOP_ORDER
				 , b.GROUP_ID
				 , b.PARENT_ID
				 , b.GROUP_NAME
				 , CONCAT(c.ID_PATH, '>', b.GROUP_ID)
			  FROM TB_MNG_GROUP b
			 INNER JOIN RE_CATE c
				ON b.TENANT_ID = #findTenantId#
			   AND c.GROUP_ID = b.PARENT_ID
					</isNotEqual>
				</isNotEmpty>
			</isEmpty>
		)
		SELECT GROUP_ID AS CODE
			 , CONCAT(REPEAT( <![CDATA['&nbsp;&nbsp;' ]]>, LEVEL - 1), GROUP_NAME) AS CODE_NM
		  FROM RE_CATE
		 ORDER BY TOP_ORDER, ID_PATH
	</select>
	
	<!-- 그룹아이디 하위포함 -->
	<select id="comboBoxCode.getGroupDepthList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getGroupDepthList */
		WITH RECURSIVE RE_CATE AS (
			SELECT 1 AS LEVEL
				 , ROW_NUMBER() OVER(ORDER BY GROUP_ID) AS TOP_ORDER
				 , GROUP_ID
				 , PARENT_ID
				 , GROUP_NAME
				 , GROUP_ID AS ID_PATH
			  FROM TB_MNG_GROUP
			 WHERE TENANT_ID = #findTenantId#
			<isNotEmpty property="controlAuth">
			   AND GROUP_ID IN (
				SELECT g.GROUP_ID
				  FROM TB_MNG_GROUP g
				 INNER JOIN TB_MNG_USERINFO u
					ON g.TENANT_ID = u.TENANT_ID
				   AND INSTR(CONCAT(',', CONTROL_AUTH, ','), CONCAT(',', g.GROUP_ID, ',')) > 0
				   AND u.USER_ID = #userId#
				   AND u.TENANT_ID = #findTenantId#
			   )
			 UNION ALL
			SELECT c.LEVEL + 1
				 , c.TOP_ORDER AS TOP_ORDER
				 , b.GROUP_ID
				 , b.PARENT_ID
				 , b.GROUP_NAME
				 , CONCAT(c.ID_PATH, '>', b.GROUP_ID)
			  FROM TB_MNG_GROUP b
			 INNER JOIN RE_CATE c
				ON b.TENANT_ID = #findTenantId#
			   AND c.GROUP_ID = b.PARENT_ID
			</isNotEmpty>
			<isEmpty property="controlAuth">
				<isEmpty property="grantId">
			   AND PARENT_ID = '0'
				</isEmpty>
				<isNotEmpty property="grantId">
					<isEqual property="grantId" compareValue="SuperAdmin">
			   AND PARENT_ID = '0'
					</isEqual>
					<isEqual property="grantId" compareValue="Manager">
			   AND PARENT_ID = '0'
					</isEqual>
					<isEqual property="grantId" compareValue="GroupManager">
			   AND GROUP_ID = ( SELECT GROUP_ID FROM TB_MNG_USERINFO WHERE USER_ID = #userId# AND TENANT_ID = #findTenantId# )
					</isEqual>
					<isEqual property="grantId" compareValue="Agent">
			   AND GROUP_ID = ( SELECT GROUP_ID FROM TB_MNG_USERINFO WHERE USER_ID = #userId# AND TENANT_ID = #findTenantId# )
					</isEqual>
					<isNotEqual property="grantId" compareValue="Agent">
			 UNION ALL
			SELECT c.LEVEL + 1
				 , c.TOP_ORDER AS TOP_ORDER
				 , b.GROUP_ID
				 , b.PARENT_ID
				 , b.GROUP_NAME
				 , CONCAT(c.ID_PATH, '>', b.GROUP_ID)
			  FROM TB_MNG_GROUP b
			 INNER JOIN RE_CATE c
				ON b.TENANT_ID = #findTenantId#
			   AND c.GROUP_ID = b.PARENT_ID
					</isNotEqual>
				</isNotEmpty>
			</isEmpty>
		)
		SELECT CONCAT(GROUP_ID, '_', LEVEL) AS CODE
			 , CONCAT(REPEAT( <![CDATA['&nbsp;&nbsp;' ]]>, LEVEL - 1), GROUP_NAME) AS CODE_NM
		  FROM RE_CATE
		 ORDER BY TOP_ORDER, ID_PATH
	</select>
	
	<!-- 그룹아이디(depth) -->
	<select id="comboBoxCode.getDepthGroupList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getDepthGroupList */
		WITH RECURSIVE RE_CATE AS (
			SELECT 1 AS LEVEL
				 , ROW_NUMBER() OVER(ORDER BY GROUP_ID) AS TOP_ORDER
				 , GROUP_ID
				 , PARENT_ID
				 , GROUP_NAME
				 , GROUP_ID AS ID_PATH
			  FROM TB_MNG_GROUP
			 WHERE TENANT_ID = #findTenantId#
			<isNotEmpty property="controlAuth">
			   AND GROUP_ID IN (
				SELECT g.GROUP_ID
				  FROM TB_MNG_GROUP g
				 INNER JOIN TB_MNG_USERINFO u
					ON g.TENANT_ID = u.TENANT_ID
				   AND INSTR(CONCAT(',', CONTROL_AUTH, ','), CONCAT(',', g.GROUP_ID, ',')) > 0
				   AND u.USER_ID = #userId#
				   AND u.TENANT_ID = #findTenantId#
			   )
			 UNION ALL
			SELECT c.LEVEL + 1
				 , c.TOP_ORDER AS TOP_ORDER
				 , b.GROUP_ID
				 , b.PARENT_ID
				 , b.GROUP_NAME
				 , CONCAT(c.ID_PATH, '>', b.GROUP_ID)
			  FROM TB_MNG_GROUP b
			 INNER JOIN RE_CATE c
				ON b.TENANT_ID = #findTenantId#
			   AND c.GROUP_ID = b.PARENT_ID
			</isNotEmpty>
			<isEmpty property="controlAuth">
				<isEmpty property="grantId">
			   AND PARENT_ID = '0'
				</isEmpty>
				<isNotEmpty property="grantId">
					<isEqual property="grantId" compareValue="SuperAdmin">
			   AND PARENT_ID = '0'
					</isEqual>
					<isEqual property="grantId" compareValue="Manager">
			   AND PARENT_ID = '0'
					</isEqual>
					<isEqual property="grantId" compareValue="GroupManager">
			   AND GROUP_ID = ( SELECT GROUP_ID FROM TB_MNG_USERINFO WHERE USER_ID = #userId# AND TENANT_ID = #findTenantId# )
					</isEqual>
					<isEqual property="grantId" compareValue="Agent">
			   AND GROUP_ID = ( SELECT GROUP_ID FROM TB_MNG_USERINFO WHERE USER_ID = #userId# AND TENANT_ID = #findTenantId# )
					</isEqual>
					<isNotEqual property="grantId" compareValue="Agent">
			 UNION ALL
			SELECT c.LEVEL + 1
				 , c.TOP_ORDER AS TOP_ORDER
				 , b.GROUP_ID
				 , b.PARENT_ID
				 , b.GROUP_NAME
				 , CONCAT(c.ID_PATH, '>', b.GROUP_ID)
			  FROM TB_MNG_GROUP b
			 INNER JOIN RE_CATE c
				ON b.TENANT_ID = #findTenantId#
			   AND c.GROUP_ID = b.PARENT_ID
					</isNotEqual>
				</isNotEmpty>
			</isEmpty>
		)
		SELECT LEVEL AS CODE
			 , CONCAT(REPEAT( <![CDATA['&nbsp;&nbsp;' ]]>, LEVEL - 1), GROUP_NAME) AS CODE_NM
		  FROM RE_CATE
		 ORDER BY TOP_ORDER, ID_PATH
	</select>
	
	<!-- 그룹 목록 -->
	<select id="comboBoxCode.getGroupListByParentCnt" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getGroupListByParentCnt */
		SELECT
			  COUNT(*) AS CNT
			FROM
			  tb_mng_group A INNER JOIN
			  (
			    SELECT 
			      TENANT_ID, PARENT_ID, COUNT(*) AS CNT
			    FROM tb_mng_group
			    WHERE ((#parentId# IS NULL OR #parentId# = '') AND DEPTH = 'A') OR  
			          ((#parentId# IS NOT NULL AND #parentId# != '') AND PARENT_ID IN (
			                        SELECT 
			                          GROUP_ID AS PARENT_ID 
			                        FROM 
			                          tb_mng_group 
			                        WHERE PARENT_ID = #parentId# AND (((#tenantId# IS NULL OR #tenantId# = '') AND 1=1) OR ((#tenantId# IS NOT NULL AND #tenantId# != '') AND TENANT_ID = #tenantId#))))
			    GROUP BY TENANT_ID, PARENT_ID
			  ) B
			  ON A.TENANT_ID = B.TENANT_ID AND A.PARENT_ID = B.PARENT_ID
			WHERE
			  ((#tenantId# IS NULL OR #tenantId# = '') AND 1=1) OR ((#tenantId# IS NOT NULL AND #tenantId# != '') AND A.TENANT_ID = #tenantId#)
	</select>
	
	<!-- 그룹 목록 -->
	<select id="comboBoxCode.getGroupListByParent" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getGroupListByParent */
		SELECT
			  GROUP_ID, GROUP_NAME
			FROM
			  tb_mng_group A INNER JOIN
			  (
			    SELECT 
			      TENANT_ID, PARENT_ID, COUNT(*) AS CNT
			    FROM tb_mng_group
			    WHERE ((#parentId# IS NULL OR #parentId# = '') AND DEPTH = 'A') OR  
			          ((#parentId# IS NOT NULL AND #parentId# != '') AND PARENT_ID IN (
			                        SELECT 
			                          GROUP_ID AS PARENT_ID 
			                        FROM 
			                          tb_mng_group 
			                        WHERE PARENT_ID = #parentId# AND (((#tenantId# IS NULL OR #tenantId# = '') AND 1=1) OR ((#tenantId# IS NOT NULL AND #tenantId# != '') AND TENANT_ID = #tenantId#))))
			    GROUP BY TENANT_ID, PARENT_ID
			  ) B
			  ON A.TENANT_ID = B.TENANT_ID AND A.PARENT_ID = B.PARENT_ID
			WHERE
			  ((#tenantId# IS NULL OR #tenantId# = '') AND 1=1) OR ((#tenantId# IS NOT NULL AND #tenantId# != '') AND A.TENANT_ID = #tenantId#)
	</select>
	
	
	<select id="comboBoxCode.getControlAuthList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getControlAuthList */
        WITH RECURSIVE RE_CATE AS (
			SELECT 1 LEVEL
				 , ROW_NUMBER() OVER() AS TOP_ORDER
				 , a.*
				 , a.GROUP_ID AS ID_PATH
			  FROM TB_MNG_GROUP a
			 WHERE TENANT_ID = #findTenantId#
			   AND PARENT_ID = '0'
			 UNION ALL
			SELECT c.LEVEL + 1
				 , c.TOP_ORDER AS TOP_ORDER
				 , b.*
				 , CONCAT(c.ID_PATH, '>', b.GROUP_ID)
			  FROM TB_MNG_GROUP b
			 INNER JOIN RE_CATE c
				ON b.TENANT_ID = #findTenantId#
			   AND c.GROUP_ID = b.PARENT_ID
		)
		SELECT GROUP_ID AS CODE
			 , CONCAT(REPEAT(<![CDATA['&nbsp;&nbsp;']]>, LEVEL - 1), GROUP_NAME) AS CODE_NM
		  FROM RE_CATE
		 ORDER BY TOP_ORDER, ID_PATH
	</select>
	
	<!-- 제어그룹에서 dept가 아닌 group id로 받기 -->
	<select id="comboBoxCode.getControlAuthCodeList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getControlAuthCodeList */
		select group_id code, replace(CONCAT(lpad('-|', (length(depth)-1)*2, '-|'), group_name),'-|',<![CDATA[ '&nbsp;&nbsp;' ]]>) code_nm
		
			FROM tb_mng_group
		where tenant_id = #findTenantId#
			<isNotEmpty property="grantId">
				<isEqual property="grantId" compareValue="GroupManager">  
					and depth in 
						(
						select g.group_id, g.depth
							from tb_mng_group g,
								(
								select group_id, depth from tb_mng_group g, tb_mng_userinfo u
								where g.tenant_id = u.tenant_id
									/*and g.group_id = u.group_id*/
									and instr(CONCAT(',', control_auth, ','), CONCAT(',', g.depth, ',')) > 0
									and u.user_id = #userId#
									and u.tenant_id = #findTenantId#
								) c
						where g.depth LIKE CONCAT(c.depth, '%')
							and tenant_id = #findTenantId#
						)
				</isEqual>
			</isNotEmpty>
			<isNotEmpty property="controlAuth">
				<isNotEqual property="grantId" compareValue="GroupManager">  
					and depth in 
						(
						select g.group_id, g.depth
							from tb_mng_group g,
								(
								select group_id, depth from tb_mng_group g, tb_mng_userinfo u
								where g.tenant_id = u.tenant_id
									/*and instr(CONCAT(',', g.depth, ','), CONCAT(',', control_auth, ',')) > 0*/
									and instr(CONCAT(',', control_auth, ','), CONCAT(',', g.depth, ',')) > 0
									and u.user_id = #userId#
									and u.tenant_id = #findTenantId#
								) c
						where g.depth LIKE CONCAT(c.depth, '%')
							and tenant_id = #findTenantId#
						)
				</isNotEqual>
			</isNotEmpty>
		order by depth
	</select>
	
	<!-- 사용자아이디 -->
	<select id="comboBoxCode.getUserListByGroup" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getUserListByGroup */
		SELECT USER_ID CODE, CONCAT(USER_NAME, '-', USER_ID) CODE_NM 
		  FROM TB_MNG_USERINFO
		 WHERE TENANT_ID = #findTenantId#	
		   AND GROUP_ID = #findGroupId# 
		 ORDER BY USER_NAME
	</select>
	
	
	<!-- 사용자아이디 -->
	<select id="comboBoxCode.getUserCodeList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getUserCodeList */
		SELECT USER_ID CODE, CONCAT(USER_NAME, '(', USER_ID, ')') CODE_NM 
		  FROM TB_MNG_USERINFO
		 WHERE TENANT_ID = #findTenantId#	
		   AND GROUP_ID = #findGroupId# 
		 ORDER BY USER_NAME
	</select>	
	
	<select id="comboBoxCode.getUserListDetail" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getUserListDetail */
		SELECT a.USER_ID, a.GROUP_ID, a.USER_NAME, b.GROUP_NAME
		  FROM TB_MNG_USERINFO a
		 INNER JOIN TB_MNG_GROUP b
			ON a.GROUP_ID = b.GROUP_ID
		 WHERE 1 = 1
		   AND (((#findTenantId# IS NULL OR #findTenantId# = '') AND 1=1) OR ((#findTenantId# IS NOT NULL AND #findTenantId# != '') AND a.TENANT_ID = #findTenantId#))
		   AND (((#findGroupId# IS NULL OR #findGroupId# = '') AND 1=1) OR ((#findGroupId# IS NOT NULL AND #findGroupId# != '') AND a.GROUP_ID = #findGroupId#))
		   AND (((#findUserName# IS NULL OR #findUserName# = '') AND 1=1) OR ((#findUserName# IS NOT NULL AND #findUserName# != '') AND a.USER_Name = #findUserName#))
		ORDER BY a.USER_NAME
	</select>
	
	<update id="comboBoxCode.updateUserAuth" parameterClass="java.util.HashMap">
		/* ID : comboBoxCode.updateUserAuth */
		UPDATE TB_MNG_USERINFO
		   SET CONTROL_AUTH = #findControlAuth#
		 WHERE TENANT_ID = #findTenantId#
		   AND USER_ID = #userid#
	</update>
	
	<update id="comboBoxCode.updateUserAuth_" parameterClass="java.util.HashMap">
		/* ID : comboBoxCode.updateUserAuth */
		UPDATE TB_MNG_USERINFO
		   SET CONTROL_AUTH = (CASE WHEN CONTROL_AUTH IS NOT NULL AND CONTROL_AUTH != '' THEN CONCAT(CONTROL_AUTH, ',', #findControlAuth#)
								   ELSE #findControlAuth#
							   END)
		 WHERE TENANT_ID = #findTenantId#
		   AND USER_ID = #userid#
	</update>
	
	<!-- 사용자아이디 -->
	<select id="comboBoxCode.getUserList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getUserList */
		SELECT USER_ID CODE, CONCAT(USER_NAME, '-', USER_ID) CODE_NM 
		  FROM TB_MNG_USERINFO
		 WHERE TENANT_ID = #findTenantId#	
		<isNotEmpty property="findGroupId"> 
		   AND GROUP_ID = LPAD(#findGroupId#, INSTR(#findGroupId#, '_') - 1, ' ') 
		</isNotEmpty> 	
		 ORDER BY USER_NAME
	</select>	
	
	<select id="comboBoxCode.TEST" parameterClass="java.util.HashMap" resultClass="egovMap">
		SELECT USER_ID
		  FROM TB_MNG_USERINFO
		 WHERE USER_ID IN ($userList$)
	</select>
	
	<!-- 사용자아이디 -->
	<select id="comboBoxCode.getUserList_Parentheses" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getUserList_Parentheses */
		SELECT USER_ID CODE, CONCAT(USER_NAME, '(', USER_ID, ')') CODE_NM 
		  FROM TB_MNG_USERINFO
		 WHERE TENANT_ID = #findTenantId#	
		<isNotEmpty property="findGroupId"> 
		   AND GROUP_ID = LPAD(#findGroupId#, INSTR(#findGroupId#, '_') - 1) 
		</isNotEmpty> 	
		 ORDER BY USER_NAME
	</select>	
       
    <!-- 마킹코드 -->
	<select id="comboBoxCode.getMarkCodeList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getMarkCodeList */
		SELECT MARKING_ID CODE, MARKING_CLASS CODE_NM, MARKING_COLOR
		  FROM TB_REC_MARKCODE
		 WHERE TENANT_ID = #findTenantId#
		 ORDER BY MARKING_ID, MARKING_CLASS 
	</select>	
	       
	<!-- 시스템 아이디-->
	<!-- <select id="comboBoxCode.getSystemList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getSystemList */
		select system_id code, system_name code_nm
			FROM tb_sys_sysinfo
		order by system_name
	</select> -->
	
	<select id="comboBoxCode.getMruSystemList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getMruSystemList */
		SELECT DISTINCT s.SYSTEM_ID CODE, SYSTEM_NAME CODE_NM, PROCESS_NAME
		  FROM TB_SYS_SYSINFO s, TB_SYS_PROCINFO p
		 WHERE s.SYSTEM_ID = p.SYSTEM_ID
		   AND p.PROCESS_CODE = '41'
		 ORDER BY SYSTEM_NAME
	</select>	
	<select id="comboBoxCode.getVssProcessList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getVssProcessList */
		SELECT SYSTEM_ID, PROCESS_ID 
		  FROM TB_SYS_PROCINFO
		 WHERE PROCESS_CODE = '43'
	</select>
				
	<select id="comboBoxCode.getMruVssSystemList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getMruVssSystemList */
		SELECT DISTINCT s.SYSTEM_ID CODE, SYSTEM_NAME CODE_NM
		  FROM TB_SYS_SYSINFO s, TB_SYS_PROCINFO p
		 WHERE s.SYSTEM_ID = p.SYSTEM_ID
		   AND (p.PROCESS_CODE='41' or p.PROCESS_CODE= '43')
		   AND IFNULL(s.SYSTEM_ID, 0) NOT IN (SELECT SLAVE_SYSTEM_ID FROM TB_SYS_PROCINFO WHERE IFNULL(SLAVE_SYSTEM_ID, 0) > 0)
		 ORDER BY SYSTEM_NAME
	</select>				
	
	<!-- 시스템 코드 -->
	<select id="comboBoxCode.getSystemId" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getSystemId */
		SELECT SYSTEM_ID CODE_NM, SYSTEM_NAME CODE
		  FROM TB_SYS_SYSINFO
		 ORDER BY SYSTEM_NAME
	</select>
	
	<!-- 시스템 이름 -->
	<select id="comboBoxCode.getSystemName" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getSystemName */
		SELECT SYSTEM_ID CODE, SYSTEM_NAME CODE_NM
		  FROM TB_SYS_SYSINFO
		 WHERE SYSTEM_ID = #findSystemId#
		 ORDER BY SYSTEM_NAME
	</select>
	
	<!-- 프로세스 아이디 -->
	<select id="comboBoxCode.getProcessList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getProcessList */
		SELECT PROCESS_ID CODE, PROCESS_NAME CODE_NM
		  FROM TB_SYS_PROCINFO
		<isNotEmpty property="findSystemId">
		 WHERE SYSTEM_ID = #findSystemId#
			<isNotEmpty property="findProcessName">
		   AND (PROCESS_CODE = '41' OR PROCESS_CODE = '43')
			</isNotEmpty>
		</isNotEmpty>
		 ORDER BY PROCESS_NAME
	</select>
	
	<select id="comboBoxCode.getProcessList2" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getProcessList2 */
		SELECT PROCESS_ID CODE, CONCAT(PROCESS_NAME, '_', PROCESS_ID) AS CODE_NM
		  FROM TB_SYS_PROCINFO
		<isNotEmpty property="findSystemId">
		 WHERE SYSTEM_ID = #findSystemId# 
			<isNotEmpty property="findProcessName">
		   AND (PROCESS_CODE = '41' OR PROCESS_CODE = '43') AND ACT_FLAG = 1
			</isNotEmpty>
		</isNotEmpty>
		 ORDER BY PROCESS_NAME
	</select>
	
	<select id="comboBoxCode.getProcessId" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getProcessId */
		SELECT PROCESS_ID CODE_NM, PROCESS_NAME CODE
		  FROM TB_SYS_PROCINFO
		 ORDER BY PROCESS_NAME
	</select>
	
	<select id="comboBoxCode.getProcessName" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getProcessName */
		SELECT PROCESS_ID CODE, PROCESS_NAME CODE_NM
		  FROM TB_SYS_PROCINFO
		 WHERE PROCESS_ID = #findProcessId#
		 ORDER BY PROCESS_NAME
	</select>
		
    <!-- 권한코드 -->
	<select id="comboBoxCode.getGrantList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getGrantList */
		SELECT GRANT_ID CODE, GRANT_NAME CODE_NM
		  FROM TB_MNG_AUTH
		 WHERE TENANT_ID = #findTenantId#
		 ORDER BY AUTH_RANK
	</select>				 
			       
    <!-- OSU IP 추출 -->
	<select id="comboBoxCode.getOsuIpList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getOsuIpList */
		SELECT SYSTEM_IP CODE, SYSTEM_ID CODE_NM 
		  FROM TB_SYS_IPINFO
		 WHERE IP_USE_ITEM LIKE '%82-1%'
	</select>				 

	<select id="comboBoxCode.getMfuIpList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getMfuIpList */
		SELECT CASE WHEN (DOMAIN_ADDR = '' OR DOMAIN_ADDR IS NULL) AND (MFU_IP = '' OR MFU_IP IS NULL) THEN SYSTEM_IP
        			WHEN (DOMAIN_ADDR = '' OR DOMAIN_ADDR IS NULL) AND (MFU_IP != '' OR MFU_IP IS NOT NULL) THEN MFU_IP
					ELSE DOMAIN_ADDR
			   END AS CODE
			 , SYSTEM_ID AS CODE_NM
			 , IP_NAT
		  FROM TB_SYS_IPINFO
		 WHERE IP_USE_ITEM LIKE '%62-1%'
		 LIMIT 1
	</select>				 
		
    <!-- MRS IP 추출 -->
	<!-- <select id="comboBoxCode.getMrsIpList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getMrsIpList */
		select system_ip code, system_id code_nm 
			from TB_SYS_IPINFO
		where ip_use_item like '%411-1%'
	</select> -->					       

    <!-- MRU Process 추출 -->
	<select id="comboBoxCode.getMruProcessList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getMruProcessList */
		SELECT SYSTEM_ID, PROCESS_ID 
		  FROM TB_SYS_PROCINFO
		 WHERE PROCESS_CODE = '41'
	</select>					       

    <!-- Dn play MRS IP 추출 -->
	<select id="comboBoxCode.getDnMrsIpList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getDnMrsIpList */
		SELECT SYSTEM_IP CODE, IP_DESC CODE_NM, ACT_FLAG 
		  FROM (
			SELECT SYSTEM_ID, PROCESS_ID, ACT_FLAG
			  FROM TB_SYS_PROCINFO
			 WHERE SYSTEM_ID    = #findSystemId# 
			   AND PROCESS_ID = #findProcessId#
			 UNION ALL
			SELECT SYSTEM_ID, PROCESS_ID, HA_MODE
			  FROM TB_SYS_PROCINFO
			 WHERE SYSTEM_ID = (SELECT SLAVE_SYSTEM_ID FROM TB_SYS_PROCINFO WHERE SYSTEM_ID = #findSystemId# AND PROCESS_ID = #findProcessId#)
			   AND PROCESS_ID = (SELECT SLAVE_PROCESS_ID FROM TB_SYS_PROCINFO WHERE SYSTEM_ID = #findSystemId# AND PROCESS_ID = #findProcessId#)
		  ) s, TB_SYS_IPINFO i
		 WHERE s.SYSTEM_ID = i.SYSTEM_ID
			<!-- and ip_use_item like #findUseNat# -->
		   AND IP_USE_ITEM LIKE '411-1%'
		 ORDER BY ACT_FLAG DESC
	</select>					       

    <!-- 메뉴 추출 -->
	<select id="comboBoxCode.getMenuList" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getMenuList */
		SELECT 
		<isNotEmpty property="actionLog">
			MENU_NAME CODE
		</isNotEmpty>
		<isEmpty property="actionLog">
			CONCAT('a_', DEPTH1_ID, '_', DEPTH2_ID, '_', DEPTH3_ID) CODE
		</isEmpty>
			 , MENU_NAME CODE_NM
		  FROM TB_MNG_MENU
		 WHERE LENGTH(SRC_DO) > 1
	</select>						       

    <!-- 메뉴 추출 -->
	<select id="comboBoxCode.getConfigValue" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* ID : comboBoxCode.getConfigValue */
		SELECT VAL_CUR CODE, KEY_CODE CODE_NM
		  FROM TB_WAS_CONFIG
		 WHERE SECTION = #section# 
		   AND KEY_CODE = #keyCode#
	</select>					
	
	<!-- VSS,MRU -->
    <select id="comboBoxCode.getMruMruVSSIpList" parameterClass="java.util.HashMap" resultClass="egovMap">
        /* ID : comboBoxCode.getMruMruVSSList */
		SELECT ip.SYSTEM_IP
		  FROM TB_SYS_PROCINFO pro
		 INNER JOIN TB_SYS_IPINFO ip
			ON pro.SYS_GROUP_ID = ip.SYS_GROUP_ID AND pro.SYSTEM_ID = ip.SYSTEM_ID
		 WHERE pro.PROCESS_CODE IN ('43','41')
		 GROUP BY SYSTEM_IP
    </select>       

    <!-- 프로세스 아이디 -->
    <select id="comboBoxCode.getSystemIdToProcessList" parameterClass="java.util.HashMap" resultClass="egovMap">
        /* ID : comboBoxCode.getSystemIdToProcessList */
		SELECT PROCESS_ID CODE, PROCESS_NAME CODE_NM
		  FROM TB_SYS_PROCINFO
		 WHERE SYSTEM_ID = #findSystemId#
		 ORDER BY PROCESS_NAME
    </select>
</sqlMap>
